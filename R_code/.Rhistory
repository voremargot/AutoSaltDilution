Calibration_Events <- fetch((dbSendQuery(con, gsub("\\n\\s+", " ", query))),n=-1)
Calibration_Events$Date= as.Date.POSIXct(Calibration_Events$Date,"%Y-%m-%d")
Calibration_Events=Calibration_Events[Calibration_Events$SensorID > 2 & Calibration_Events$SensorID <33 & Calibration_Events$SiteID==Station,]
ID= unique(Calibration_Events$CalibrationID)
Num=1
for (x in ID){
W= Calibration_Events[Calibration_Events$CalibrationID==x,]
for (S in unique(W$SensorID)){
Use= W[W$SensorID==S,]
if (nrow(Use)<2){
next()
}
Diff= max(Use$CF_Value)-min(Use$CF_Value)
DF= data.frame(Number=Num,Site= Station, CalEvent=x, Sensor=S, Difference= Diff)
Results= rbind(Results, DF)
Num=Num+1
}
}
}
Results
ggplot(Results, aes(Site, Difference))+geom_boxplot()
ggplot(Results, aes(Site, Difference, group=as.character(Site)))+geom_boxplot()
ggplot(Results, aes(as.character(Site), Difference, group=as.character(Site)))+geom_boxplot()
ggplot(Results, aes(as.character(Site), Difference, group=as.character(Site)))+geom_boxplot()+coord_cartesian(y=c(0,0.1))
Results$Site= factor(as.character(Results$Site), levels= c('626','703','844','1015','693','708','819')
Results$Site= factor(as.character(Results$Site), levels= c('626','703','844','1015','693','708','819'))
Results$Site= factor(as.character(Results$Site), levels= c('626','703','844','1015','693','708','819'))
ggplot(Results, aes(Site, Difference, group=Site))+geom_boxplot()+coord_cartesian(y=c(0,0.1))
ggplot(Results, aes(Site, Difference, group=Site))+geom_boxplot()+coord_cartesian(y=c(0,0.1))+geom_hline(yintercept=0.025)
ggplot(Results, aes(Site, Difference, group=Site))+geom_boxplot()+coord_cartesian(y=c(0,0.1))+geom_hline(yintercept=0.025)+
labs(x='Site',y='CF diff within trials')
readRenviron('C:/Program Files/R/R-3.6.2/.Renviron')
options(java.parameters = c("-XX:+UseConcMarkSweepGC", "-Xmx8192m"))
library(DBI)
library(curl)
con <- dbConnect(RPostgres::Postgres(), dbname=Sys.getenv('dbname'),host=Sys.getenv('host'),user=Sys.getenv('user'),password=Sys.getenv('password'))
Site=626
Rating_Curve_Version=5
query= sprintf("SELECT * FROM chrl.autosalt_summary WHERE SiteID=%s",Site)
autosalt_summary= dbGetQuery(con,query)
autosalt_summary= autosalt_summary[is.na(autosalt_summary$discharge_avg)==FALSE,]
query= sprintf("SELECT * FROM chrl.RC_summary WHERE SiteID=%s AND Version=%s",Site, (Rating_Curve_Version-1))
PreviousRC= dbGetQuery(con,query)
RCID= PreviousRC$rcid
query=sprintf("SELECT * FROM chrl.rcautosalt WHERE SiteID=%s AND RCID=%s",Site,RCID)
Autosalt_included= dbGetQuery(con,query)
for (r in c(1:nrow(autosalt_summary))){
EventID= autosalt_summary[r,'eventid']
if (nrow(Autosalt_included[Autosalt_included$eventid==EventID,])>=1){
autosalt_summary[r,'Included']='Y'
} else {
autosalt_summary[r,'Included']='N'
}
}
autosalt_summary
RC_summary
PreviousRC
EndDate= as.Date(PreviousRC$end_date)
EndDate
autosalt_summary[autosalt_summary$date<= EndDate,]
autosalt_summary[autosalt_summary$date <= EndDate,'OldNew']='Old'
autosalt_summary[autosalt_summary$date > EndDate,'OldNew']='New'
autosalt_summary
tail(autosalt_summary)
Autosalt_included
Autosalt_included[Autosalt_included$eventid==EventID,'eventno']
Autosalt_included
Autosalt_included[Autosalt_included$eventid==EventID,]
query= sprintf("SELECT * FROM chrl.autosalt_summary WHERE SiteID=%s",Site)
autosalt_summary= dbGetQuery(con,query)
autosalt_summary= autosalt_summary[is.na(autosalt_summary$discharge_avg)==FALSE,]
query= sprintf("SELECT * FROM chrl.RC_summary WHERE SiteID=%s AND Version=%s",Site, (Rating_Curve_Version-1))
PreviousRC= dbGetQuery(con,query)
RCID= PreviousRC$rcid
EndDate= as.Date(PreviousRC$end_date)
query=sprintf("SELECT * FROM chrl.rcautosalt WHERE SiteID=%s AND RCID=%s",Site,RCID)
Autosalt_included= dbGetQuery(con,query)
for (r in c(1:nrow(autosalt_summary))){
EventID= autosalt_summary[r,'eventid']
if (nrow(Autosalt_included[Autosalt_included$eventid==EventID,])>=1){
autosalt_summary[r,'Included']='Y'
autosalt_summary[r,'EventNumber']=Autosalt_included[Autosalt_included$eventid==EventID,'eventno']
} else {
autosalt_summary[r,'Included']='N'
autosalt_summary[r,'EventNumber']=NA
}
}
autosalt_summary[autosalt_summary$date <= EndDate,'OldNew']='Old'
autosalt_summary[autosalt_summary$date > EndDate,'OldNew']='New'
autosalt_summary
tail(autosalt_summary)
autosalt_summary[r,'date'].year
as.Date(autosalt_summary[r,'date'])
Year=format(as.Date(autosalt_summary[r,'date']),'%Y')
Month= format(as.Date(autosalt_summary[r,'date']),'%M')
Year
Month
format(as.Date(autosalt_summary[r,'date']),'%m')
Year=as.numeric(format(as.Date(autosalt_summary[r,'date']),'%Y'))
Month= as.numeric(format(as.Date(autosalt_summary[r,'date']),'%m'))
Year
Moth
Month
Site=626
Rating_Curve_Version=5
query= sprintf("SELECT * FROM chrl.autosalt_summary WHERE SiteID=%s",Site)
autosalt_summary= dbGetQuery(con,query)
autosalt_summary= autosalt_summary[is.na(autosalt_summary$discharge_avg)==FALSE,]
query= sprintf("SELECT * FROM chrl.RC_summary WHERE SiteID=%s AND Version=%s",Site, (Rating_Curve_Version-1))
PreviousRC= dbGetQuery(con,query)
RCID= PreviousRC$rcid
EndDate= as.Date(PreviousRC$end_date)
query=sprintf("SELECT * FROM chrl.rcautosalt WHERE SiteID=%s AND RCID=%s",Site,RCID)
Autosalt_included= dbGetQuery(con,query)
for (r in c(1:nrow(autosalt_summary))){
EventID= autosalt_summary[r,'eventid']
Year=as.numeric(format(as.Date(autosalt_summary[r,'date']),'%Y'))
Month= as.numeric(format(as.Date(autosalt_summary[r,'date']),'%m'))
if (Month >=10){
WY= sprintf('%s-%s',Year,(Year+1))
} else {
WY= sprintf('%s-%s',(Year-1),Year)
}
autosalt_summary[r,'WY']=WY
if (nrow(Autosalt_included[Autosalt_included$eventid==EventID,])>=1){
autosalt_summary[r,'Included']='Y'
autosalt_summary[r,'EventNumber']=Autosalt_included[Autosalt_included$eventid==EventID,'eventno']
} else {
autosalt_summary[r,'Included']='N'
autosalt_summary[r,'EventNumber']=NA
}
}
autosalt_summary[autosalt_summary$date <= EndDate,'OldNew']='Old'
autosalt_summary[autosalt_summary$date > EndDate,'OldNew']='New'
autosalt_summary
tail(autosalt_summary)
autosalt_summary[,c('eventid','siteid','date','start_time','WY','OldNew','EventNumber','Included','stage_average','stage_std','stage_dir',
'discharge_avg','uncert','mixing','ecb')]
Site=626
Rating_Curve_Version=5
query= sprintf("SELECT * FROM chrl.autosalt_summary WHERE SiteID=%s",Site)
autosalt_summary= dbGetQuery(con,query)
autosalt_summary= autosalt_summary[is.na(autosalt_summary$discharge_avg)==FALSE,]
query= sprintf("SELECT * FROM chrl.RC_summary WHERE SiteID=%s AND Version=%s",Site, (Rating_Curve_Version-1))
PreviousRC= dbGetQuery(con,query)
RCID= PreviousRC$rcid
EndDate= as.Date(PreviousRC$end_date)
query=sprintf("SELECT * FROM chrl.rcautosalt WHERE SiteID=%s AND RCID=%s",Site,RCID)
Autosalt_included= dbGetQuery(con,query)
for (r in c(1:nrow(autosalt_summary))){
EventID= autosalt_summary[r,'eventid']
Year=as.numeric(format(as.Date(autosalt_summary[r,'date']),'%Y'))
Month= as.numeric(format(as.Date(autosalt_summary[r,'date']),'%m'))
if (Month >=10){
WY= sprintf('%s-%s',Year,(Year+1))
} else {
WY= sprintf('%s-%s',(Year-1),Year)
}
autosalt_summary[r,'WY']=WY
if (nrow(Autosalt_included[Autosalt_included$eventid==EventID,])>=1){
autosalt_summary[r,'Included']='Y'
autosalt_summary[r,'EventNumber']=Autosalt_included[Autosalt_included$eventid==EventID,'eventno']
} else {
autosalt_summary[r,'Included']='N'
autosalt_summary[r,'EventNumber']=NA
}
}
autosalt_summary[autosalt_summary$date <= EndDate,'OldNew']='Old'
autosalt_summary[autosalt_summary$date > EndDate,'OldNew']='New'
autosalt_summmary$Method='Autosalt'
autosalt_summary$MID=NA
Final=autosalt_summary[,c('eventid','MID','siteid','Method','date','start_time','WY','OldNew','EventNumber','Included','stage_average','stage_std','stage_dir',
'discharge_avg','uncert','mixing','ecb')]
autosalt_summary$Method='Autosalt'
autosalt_summary$MID=NA
Final=autosalt_summary[,c('eventid','MID','siteid','Method','date','start_time','WY','OldNew','EventNumber','Included','stage_average','stage_std','stage_dir',
'discharge_avg','uncert','mixing','ecb')]
Fibal
Final
query= sprintf("SELECT * FROM chrl.manual_discharge WHERE SiteID=%s",Site)
manual_summary= dbGetQuery(con,query)
manual_summary= manual_summary[is.na(autosalt_summary$discharge_avg)==FALSE,]
manual_summary
manual_summary= manual_summary[is.na(autosalt_summary$discharge)==FALSE,]
manual_summary= manual_summary[is.na(manual_summary$discharge)==FALSE,]
query=sprintf("SELECT * FROM chrl.rcmanual WHERE SiteID=%s AND RCID=%s",Site,RCID)
Manual_included= dbGetQuery(con,query)
query= sprintf("SELECT * FROM chrl.manual_discharge WHERE SiteID=%s",Site)
manual_summary= dbGetQuery(con,query)
manual_summary= manual_summary[is.na(manual_summary$discharge)==FALSE,]
Manual_included
manual_summary
for (r in c(1:nrow(manual_summary))){
Year=as.numeric(format(as.Date(manual_summary[r,'date']),'%Y'))
Month= as.numeric(format(as.Date(manual_summary[r,'date']),'%m'))
if (Month >=10){
WY= sprintf('%s-%s',Year,(Year+1))
} else {
WY= sprintf('%s-%s',(Year-1),Year)
}
manual_summary[r,'WY']=WY
MDisID= manual_summary[r,'mdisid']
if (nrow(Manual_included[Manual_included$mdisid==MDisID,])>=1){
manual_summary[r,'Included']='Y'
manual_summary[r,'EventNumber']=Manual_included[Manual_included$mdisid==MDisID,'eventno']
} else {
manual_summary[r,'Included']='N'
manual_summary[r,'EventNumber']=NA
}
}
manual_summary
Final
colnames(Final)
manual_summary$eventid=NA
manual_summary$stage_std=NA
manual_summary$stage_dir=NA
manual_summary$mixing= NA
manual_sumamry$ecb=NA
manual_summary$ecb=NA
colnames(manual_summary)
manual_summary[manual_summary$date <= EndDate,'OldNew']='Old'
manual_summary[manual_summary$date > EndDate,'OldNew']='New'
manual_summary
colnames(Final)
colnames(manual_summary)
Site=626
Rating_Curve_Version=5
query= sprintf("SELECT * FROM chrl.autosalt_summary WHERE SiteID=%s",Site)
autosalt_summary= dbGetQuery(con,query)
autosalt_summary= autosalt_summary[is.na(autosalt_summary$discharge_avg)==FALSE,]
query= sprintf("SELECT * FROM chrl.RC_summary WHERE SiteID=%s AND Version=%s",Site, (Rating_Curve_Version-1))
PreviousRC= dbGetQuery(con,query)
RCID= PreviousRC$rcid
EndDate= as.Date(PreviousRC$end_date)
query=sprintf("SELECT * FROM chrl.rcautosalt WHERE SiteID=%s AND RCID=%s",Site,RCID)
Autosalt_included= dbGetQuery(con,query)
for (r in c(1:nrow(autosalt_summary))){
EventID= autosalt_summary[r,'eventid']
Year=as.numeric(format(as.Date(autosalt_summary[r,'date']),'%Y'))
Month= as.numeric(format(as.Date(autosalt_summary[r,'date']),'%m'))
if (Month >=10){
WY= sprintf('%s-%s',Year,(Year+1))
} else {
WY= sprintf('%s-%s',(Year-1),Year)
}
autosalt_summary[r,'WY']=WY
if (nrow(Autosalt_included[Autosalt_included$eventid==EventID,])>=1){
autosalt_summary[r,'Included']='Y'
autosalt_summary[r,'EventNumber']=Autosalt_included[Autosalt_included$eventid==EventID,'eventno']
} else {
autosalt_summary[r,'Included']='N'
autosalt_summary[r,'EventNumber']=NA
}
}
autosalt_summary[autosalt_summary$date <= EndDate,'OldNew']='Old'
autosalt_summary[autosalt_summary$date > EndDate,'OldNew']='New'
autosalt_summary$Method='Autosalt'
autosalt_summary$MID=NA
Final=autosalt_summary[,c('eventid','MID','siteid','Method','date','start_time','WY','OldNew','EventNumber','Included','stage_average','stage_std','stage_dir',
'discharge_avg','uncert','mixing','ecb','comment')]
##-------------------------------------------------------------------------------------
##-------------------------Manual discharge--------------------------------------------
##-------------------------------------------------------------------------------------
query=sprintf("SELECT * FROM chrl.rcmanual WHERE SiteID=%s AND RCID=%s",Site,RCID)
Manual_included= dbGetQuery(con,query)
query= sprintf("SELECT * FROM chrl.manual_discharge WHERE SiteID=%s",Site)
manual_summary= dbGetQuery(con,query)
manual_summary= manual_summary[is.na(manual_summary$discharge)==FALSE,]
for (r in c(1:nrow(manual_summary))){
Year=as.numeric(format(as.Date(manual_summary[r,'date']),'%Y'))
Month= as.numeric(format(as.Date(manual_summary[r,'date']),'%m'))
if (Month >=10){
WY= sprintf('%s-%s',Year,(Year+1))
} else {
WY= sprintf('%s-%s',(Year-1),Year)
}
manual_summary[r,'WY']=WY
MDisID= manual_summary[r,'mdisid']
if (nrow(Manual_included[Manual_included$mdisid==MDisID,])>=1){
manual_summary[r,'Included']='Y'
manual_summary[r,'EventNumber']=Manual_included[Manual_included$mdisid==MDisID,'eventno']
} else {
manual_summary[r,'Included']='N'
manual_summary[r,'EventNumber']=NA
}
}
manual_summary[manual_summary$date <= EndDate,'OldNew']='Old'
manual_summary[manual_summary$date > EndDate,'OldNew']='New'
manual_summary$eventid=NA
manual_summary$stage_std=NA
manual_summary$stage_dir=NA
manual_summary$mixing= NA
manual_summary$ecb=NA
autosalt_summary
Final=autosalt_summary[,c('eventid','MID','siteid','Method','date','start_time','WY','OldNew','EventNumber','Included','stage_average','stage_std','stage_dir',
'discharge_avg','uncert','mixing','ecb','notes')]
##-------------------------------------------------------------------------------------
##-------------------------Manual discharge--------------------------------------------
##-------------------------------------------------------------------------------------
query=sprintf("SELECT * FROM chrl.rcmanual WHERE SiteID=%s AND RCID=%s",Site,RCID)
Manual_included= dbGetQuery(con,query)
query= sprintf("SELECT * FROM chrl.manual_discharge WHERE SiteID=%s",Site)
manual_summary= dbGetQuery(con,query)
manual_summary= manual_summary[is.na(manual_summary$discharge)==FALSE,]
for (r in c(1:nrow(manual_summary))){
Year=as.numeric(format(as.Date(manual_summary[r,'date']),'%Y'))
Month= as.numeric(format(as.Date(manual_summary[r,'date']),'%m'))
if (Month >=10){
WY= sprintf('%s-%s',Year,(Year+1))
} else {
WY= sprintf('%s-%s',(Year-1),Year)
}
manual_summary[r,'WY']=WY
MDisID= manual_summary[r,'mdisid']
if (nrow(Manual_included[Manual_included$mdisid==MDisID,])>=1){
manual_summary[r,'Included']='Y'
manual_summary[r,'EventNumber']=Manual_included[Manual_included$mdisid==MDisID,'eventno']
} else {
manual_summary[r,'Included']='N'
manual_summary[r,'EventNumber']=NA
}
}
manual_summary[manual_summary$date <= EndDate,'OldNew']='Old'
manual_summary[manual_summary$date > EndDate,'OldNew']='New'
manual_summary$eventid=NA
manual_summary$stage_std=NA
manual_summary$stage_dir=NA
manual_summary$mixing= NA
manual_summary$ecb=NA
rbind(Final, manual_summary[,c('eventid','mdisid','siteid','method','date','time','WY','OldNew','EventNumber','Included',
'stage','stage_std','discharge','uncert','mixing','ecb','comment')])
colnames(Final)
colnames(manual_summary)
rbind(Final, manual_summary[,c('eventid','mdisid','siteid','method','date','time','WY','OldNew','EventNumber','Included',
'stage','stage_std','stage_dir','discharge','uncert','mixing','ecb','comment')])
library(tidyverse)
manual_summary %>%
rename(mdisid=MID)
rename(manual_summary, mdisid=MID)
rename(manual_summary,MID=  mdisid)
manual_summary %>%
rename(MID=  mdisid)
colnames(Final)
colnames(manual_summary)
manual_summary= manual_summary %>%
rename(MID=  mdisid) %>%
rename(start_time = time)  %>%
rename(stage_average= stage)%>%
rename(discharge_avg = discharge)%>%
rename(notes= comment)
rbind(Final, manual_summary[,c('eventid','mdisid','siteid','method','date','time','WY','OldNew','EventNumber','Included',
'stage','stage_std','stage_dir','discharge','uncert','mixing','ecb','comment')])
rbind(Final, manual_summary[,c('eventid','MID','siteid','method','date','start_time','WY','OldNew','EventNumber','Included',
'stage_average','stage_std','stage_dir','discharge_avg','uncert','mixing','ecb','notes')])
colnames(Final)
colnames(manual_summary)
query=sprintf("SELECT * FROM chrl.rcmanual WHERE SiteID=%s AND RCID=%s",Site,RCID)
Manual_included= dbGetQuery(con,query)
query= sprintf("SELECT * FROM chrl.manual_discharge WHERE SiteID=%s",Site)
manual_summary= dbGetQuery(con,query)
manual_summary= manual_summary[is.na(manual_summary$discharge)==FALSE,]
for (r in c(1:nrow(manual_summary))){
Year=as.numeric(format(as.Date(manual_summary[r,'date']),'%Y'))
Month= as.numeric(format(as.Date(manual_summary[r,'date']),'%m'))
if (Month >=10){
WY= sprintf('%s-%s',Year,(Year+1))
} else {
WY= sprintf('%s-%s',(Year-1),Year)
}
manual_summary[r,'WY']=WY
MDisID= manual_summary[r,'mdisid']
if (nrow(Manual_included[Manual_included$mdisid==MDisID,])>=1){
manual_summary[r,'Included']='Y'
manual_summary[r,'EventNumber']=Manual_included[Manual_included$mdisid==MDisID,'eventno']
} else {
manual_summary[r,'Included']='N'
manual_summary[r,'EventNumber']=NA
}
}
manual_summary[manual_summary$date <= EndDate,'OldNew']='Old'
manual_summary[manual_summary$date > EndDate,'OldNew']='New'
manual_summary$eventid=NA
manual_summary$stage_std=NA
manual_summary$stage_dir=NA
manual_summary$mixing= NA
manual_summary$ecb=NA
manual_summary= manual_summary %>%
rename(MID=  mdisid) %>%
rename(start_time = time)  %>%
rename(stage_average= stage)%>%
rename(discharge_avg = discharge)%>%
rename(notes= comment) %>%
rename( Method= method )
rbind(Final, manual_summary[,c('eventid','MID','siteid','Method','date','start_time','WY','OldNew','EventNumber','Included',
'stage_average','stage_std','stage_dir','discharge_avg','uncert','mixing','ecb','notes')])
Final= rbind(Final, manual_summary[,c('eventid','MID','siteid','Method','date','start_time','WY','OldNew','EventNumber','Included',
'stage_average','stage_std','stage_dir','discharge_avg','uncert','mixing','ecb','notes')])
Final
Final = Final %>%
rename(Old_New=OldNew) %>%
rename(Event_no = EventNumber) %>%
rename(Date= date) %>%
rename(Final_rating_curve= Included)%>%
rename(Start_time= start_time ) %>%
rename(Stage_avg= stage_average) %>%
rename(Stage_stdv= stage_std) %>%
rename(Stage_delta= stage_dir) %>%
rename(Q_meas= discharge_avg) %>%
rename(Q_rel_unc=  uncer) %>%
rename(Mixing= mixing) %>%
rename(Comments= notes)
Final = Final %>%
rename(Old_New=OldNew) %>%
rename(Event_no = EventNumber) %>%
rename(Date= date) %>%
rename(Final_rating_curve= Included)%>%
rename(Start_time= start_time ) %>%
rename(Stage_avg= stage_average) %>%
rename(Stage_stdv= stage_std) %>%
rename(Stage_delta= stage_dir) %>%
rename(Q_meas= discharge_avg) %>%
rename(Q_rel_unc=  uncert) %>%
rename(Mixing= mixing) %>%
rename(Comments= notes)
write.csv(Final, 'working_directory/Metadata_RC_%s_V%s.csv',626,Rating_Curve_Version)
getwd
getwd()
setwd("C:/Users/margo.DESKTOP-T66VM01/Desktop/VIU/GitHub/R_code")
write.csv(Final, 'working_directory/Metadata_RC_%s_V%s.csv',Site,Rating_Curve_Version)
write.csv(Final, sprintf('working_directory/Metadata_RC_%s_V%s.csv',Site,Rating_Curve_Version))
write.csv(Final, sprintf('working_directory/Metadata_RC_%s_V%s.csv',Site,Rating_Curve_Version), row.names = FALSE)
RC= read.csv(sprintf('working_directory/Metadata_RC_%s_V%s.csv',Site,Rating_Curve_Version))
RC
query=sprintf("SELECT * FROM chrl.rcautosalt WHERE SiteID=%s AND RCID=%s",Site,RCID)
source('C:/Users/margo.DESKTOP-T66VM01/Desktop/VIU/GitHub/R_code/Extracting_data_for_rating_curves.R', echo=TRUE)
RC= read.csv(sprintf('working_directory/Metadata_RC_%s_V%s.csv',Site,Rating_Curve_Version))
RC
RC_autosalt= RC[is.na(RC$EventID=FALSE),]
RC_autosalt= RC[which(is.na(RC$EventID)==FALSE)),]
RC_autosalt= RC[which(is.na(RC$EventID)==FALSE),]
RC_autosalt
RC_autosalt= RC[which(is.na(RC$EventID)==FALSE & RC$Final_rating_curve=='Y') ,]
RC_autosalt
AS_DF= data.frame()
for (r in c(1:nrow(RC_autosalt))){
A= data.frame(SiteID= RC_autosalt$SiteID,EventID=RC_autosalt$EventID,RCID= RCID,EventNo= RC_autosalt$Event_no)
AS_DF= rbind(AS_DF,A)
}
AS_DF
RC_manual= RC[which(is.na(RC$MID)==FALSE & RC$Final_rating_curve=='Y') ,]
RC_manual
RC_manual= RC[which(is.na(RC$MID)==FALSE & RC$Final_rating_curve=='Y') ,]
M_DF= data.frame()
for (r in c(1:nrow(RC_manual))){
A= data.frame(SiteID= RC_manual$SiteID,MDisID=RC_manual$MID,RCID= RCID,EventNo= RC_manual$Event_no)
M_DF= rbind(M_DF,A)
}
M_DF
RC_manual= RC[which(is.na(RC$MID)==FALSE & RC$Final_rating_curve=='Y') ,]
M_DF= data.frame()
for (r in c(1:nrow(RC_manual))){
A= data.frame(SiteID= RC_manual$SiteID,MDisID=RC_manual$MID,RCID= RCID,EventNo= RC_manual$Event_no)
M_DF= rbind(M_DF,A)
}
M_DF
nrow(RC_manual)
data.frame(SiteID= RC_manual$SiteID,MDisID=RC_manual$MID,RCID= RCID,EventNo= RC_manual$Event_no)
RC_manual= RC[which(is.na(RC$MID)==FALSE & RC$Final_rating_curve=='Y') ,]
M_DF= data.frame()
for (r in c(1:nrow(RC_manual))){
A= data.frame(SiteID= RC_manual[r,'SiteID'],MDisID=RC_manualr,'MID'],RCID= RCID,EventNo= RC_manual[r,'Event_no'])
M_DF= rbind(M_DF,A)
}
RC_manual= RC[which(is.na(RC$MID)==FALSE & RC$Final_rating_curve=='Y') ,]
M_DF= data.frame()
for (r in c(1:nrow(RC_manual))){
A= data.frame(SiteID= RC_manual[r,'SiteID'],MDisID=RC_manual[r,'MID'],RCID= RCID,EventNo= RC_manual[r,'Event_no'])
M_DF= rbind(M_DF,A)
}
M_DF
RC_autosalt= RC[which(is.na(RC$EventID)==FALSE & RC$Final_rating_curve=='Y') ,]
AS_DF= data.frame()
for (r in c(1:nrow(RC_autosalt))){
A= data.frame(SiteID= RC_autosalt[r,'SiteID'],EventID=RC_autosalt[r,'EventID'],RCID= RCID,EventNo= RC_autosalt[r,'Event_no'])
AS_DF= rbind(AS_DF,A)
}
AS_DF
RC_manual= RC[which(is.na(RC$MID)==FALSE & RC$Final_rating_curve=='Y') ,]
r=1
query(sprintf('INSERT INTO chrl.rcautosalt (SiteID,EventID,RCID,EventNo) VALUES (%s,%s,%s,%s)',
AS_DF[r,'SiteID'],AS_DF[r,'EventID'],AS_DF[r,'RCID'],AS_DF[r,'Event_no']))
query <- gsub("\\n\\s+", " ", query)
query <- gsub('NA',"NULL", query)
query= (sprintf('INSERT INTO chrl.rcautosalt (SiteID,EventID,RCID,EventNo) VALUES (%s,%s,%s,%s)',
AS_DF[r,'SiteID'],AS_DF[r,'EventID'],AS_DF[r,'RCID'],AS_DF[r,'Event_no']))
query <- gsub("\\n\\s+", " ", query)
query <- gsub('NA',"NULL", query)
query
AS_DF[r,'SiteID']
AS_DF[r,'EventID']
AS_DF[r,'RCID']
AS_DF[r,'Event_no']
query= (sprintf('INSERT INTO chrl.rcautosalt (SiteID,EventID,RCID,EventNo) VALUES (%s,%s,%s,%s)',
AS_DF[r,'SiteID'],AS_DF[r,'EventID'],AS_DF[r,'RCID'],AS_DF[r,'EventNo']))
query <- gsub("\\n\\s+", " ", query)
query <- gsub('NA',"NULL", query)
query
M_DF
query= (sprintf('INSERT INTO chrl.rcmanual (SiteID,MDisID,RCID,EventNo) VALUES (%s,%s,%s,%s)',
M_DF[r,'SiteID'],M_DF[r,'MDisID'],AS_DF[r,'RCID'],AS_DF[r,'EventNo']))
query <- gsub("\\n\\s+", " ", query)
query <- gsub('NA',"NULL", query)
